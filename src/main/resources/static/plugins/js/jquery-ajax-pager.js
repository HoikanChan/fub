!function(t,e){var a=t.tablePager={opts:{length:10,preText:"上一页",nextText:"下一页",firstText:"",lastText:"",shiftingLeft:3,shiftingRight:3,preLeast:2,nextLeast:2,showFirst:!1,showLast:!1,loadTarget:null,lengthName:"limit",pagerName:"page",url:"",type:"GET",dataType:"JSON",searchParam:{},beforeSend:null,success:null,complete:null,error:function(){alert("抱歉,请求出错,请重新请求！")},page:1,totalCount:0,totalPage:0},pagerElement:null,commonHtmlText:{spanHtml:"<span class='{0} pager-btn'>{1}</span>",pageIndexHtml:"<a class='pager-btn' href='javascript:void(0)' onclick='tablePager.doPage({0},{1},{2})'>{3}</a>",rightHtml:"<span class='text'>每页 {0} 条记录， 共{1}页{2}条记录，当前第<span class='current-Page'>{3}</span>页</span>",buttonHtml:"<input type='text' id='txtToPager' /><button id='btnJump' onclick='tablePager.jumpToPage();return false;' >跳转</button>",clearFloatHtml:"<div style='clear:both; class='pager-btn'></div>",stringEmpty:""},init:function(t,a){var s=this;return s.opts=e.extend({},s.opts,a),s.opts.page=s.opts.searchParam.page?s.opts.searchParam.page:1,s.pagerElement=t,s.doPage(s.opts.page,s.opts.length,s.opts.searchParam),s.opts},doPage:function(t,a,s){var o=this;o.opts.page=t,o.opts.length=a,o.opts.searchParam=s,e()._Ajax?e(e.extend(o.opts.searchParam||{},{page:o.opts.page,limit:o.opts.length||10}))._Ajax({type:o.opts.type,dataType:o.opts.dataType,loadTarget:o.opts.loadTarget,async:o.opts.async,url:o.opts.url,success:function(t){if(o.opts.success(t),o.opts.totalCount=t.totalItems,o.getTotalPage(),o.opts.totalCount>0&&o.opts.page>0){var e=new Array;o.createPreAndFirstBtn(e),o.createNextAndLastBtn(e),o.renderHtml(e)}}}):e.ajax({type:o.opts.type,data:e.extend(o.opts.searchParam||{},{page:o.opts.page,limit:o.opts.length||10}),async:o.opts.async,dataType:o.opts.dataType,url:o.opts.url,beforeSend:function(){o.opts.beforeSend()},error:function(t,e,a){o.opts.error(t,e,a)},success:function(t){if(o.opts.success(t),o.opts.totalCount=t.totalItems,o.getTotalPage(),o.opts.totalCount>0&&o.opts.page>0){var e=new Array;o.createPreAndFirstBtn(e),o.createNextAndLastBtn(e),o.renderHtml(e)}},complete:function(){o.opts.complete()}})},getTotalPage:function(){var t=this;t.opts.totalPage=Math.ceil(t.opts.totalCount/t.opts.length)},createPreAndFirstBtn:function(t){var e=this;1==e.opts.page?(e.opts.showFirst&&t.push(e.createSpan(e.opts.firstText,"disenable")),t.push(e.createSpan(e.opts.preText,"disenable"))):(e.opts.showFirst&&t.push(e.createIndexText(1,e.opts.firstText)),t.push(e.createIndexText(e.opts.page-1,e.opts.preText)))},createNextAndLastBtn:function(t){var e=this;e.opts.page==e.opts.totalPage?(t.push(e.createSpan(e.opts.nextText,"disenable")),e.opts.showLast&&t.push(e.createSpan(e.opts.lastText,"disenable"))):(t.push(e.createIndexText(e.opts.page+1,e.opts.nextText)),e.opts.showLast&&t.push(e.createIndexText(e.opts.totalPage,e.opts.lastText)))},createIndexBtn:function(t){var e=this,a=e.opts.shiftingLeft+e.opts.preLeast+1,s=e.opts.totalPage-e.opts.shiftingRight-e.opts.nextLeast-1;if(e.opts.page>a){for(i=1;i<=e.opts.preLeast;i++)t.push(e.createIndexText(i,i));for(t.push(e.createSpan("...")),i=e.opts.page-e.opts.shiftingLeft;i<e.opts.page;i++)t.push(e.createIndexText(i,i))}else for(i=1;i<e.opts.page;i++)t.push(e.createIndexText(i,i));if(t.push(e.createSpan(e.opts.page,"current")),e.opts.page<=s){for(i=e.opts.page+1;i<e.opts.page+1+e.opts.shiftingRight;i++)t.push(e.createIndexText(i,i));for(t.push(e.createSpan("...")),i=e.opts.totalPage-1;i<=e.opts.totalPage;i++)t.push(e.createIndexText(i,i))}else for(i=e.opts.page+1;i<=e.opts.totalPage;i++)t.push(e.createIndexText(i,i))},renderHtml:function(t){for(var e=this,a=e.commonHtmlText.stringEmpty,s=0;s<t.length;s++)a+=t[s];e.pagerElement.html(stringFormat(e.commonHtmlText.rightHtml,e.opts.length,e.opts.totalPage,e.opts.totalCount,e.opts.page,e.opts.page)).append(a).append(e.commonHtmlText.buttonHtml).append(e.commonHtmlText.clearFloatHtml)},createSpan:function(t,e){var a=this;return stringFormat(a.commonHtmlText.spanHtml,e||a.commonHtmlText.stringEmpty,t)},createIndexText:function(t,e){var a=this;return stringFormat(a.commonHtmlText.pageIndexHtml,t,a.opts.length,JSON.stringify(a.opts.searchParam),e)},jumpToPage:function(){var t=this,a=e("#txtToPager",t.pagerElement),s=parseInt(a.val());!isNaN(s)&&s>0&&s<=t.opts.totalPage?t.doPage(s,t.opts.length,t.opts.searchParam):a.focus()}};e(document).on("keydown","#txtToPager",function(t){if(13===t.which)return t.preventDefault(),a.jumpToPage(),!1}),e.fn.tablePager=function(t){return a.init(e(this),t)}}(window,jQuery);