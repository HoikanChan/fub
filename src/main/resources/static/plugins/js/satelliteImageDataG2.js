function TableSorter(t){if(this.Table=this.$(t),!(this.Table.rows.length<=1)){var i=[];if(arguments.length>1)for(var e=1;e<arguments.length;e++)i.push(arguments[e]);this.Init(i)}}$(function(t){var i=function(i,e){this.defaults={id:"",thead:"",url:null,columns:null,data:null,i:0,indSa:0,ind:0,otherfunction:null,callback:null},this.settings=t.extend({},this.defaults,e)};i.prototype={_id:null,_thead:null,_op:null,init:function(){this._thead=this.settings.thead,this._id=this.settings.id,_op=this,this.create(),this.loadData(this.settings.data),this.bindEvent()},create:function(){this.InitializeElement(),this.createTableHead(),this.createTableBody()},bindEvent:function(){this.registercheckall()},InitializeElement:function(){t("#"+this._thead).empty().append("<colgroup><col style='width:50px'><col><col><col style='width:100px'></colgroup><thead><tr></tr></thead>"),t("#"+this._id).empty().append("<colgroup><col style='width:50px'><col><col><col style='width:100px'></colgroup><thead><tr></tr></thead><tbody id='tbodyInit'></tbody><tfoot></tfoot>")},createTableHead:function(){for(var i=this.settings.columns,e=t("table[id='"+this._thead+"'] thead tr"),s=t("table[id='"+this._id+"'] thead tr"),a=0;a<i.length;a++)"ck"==i[a].field?(e.append("<th width="+i[a].width+" align="+i[a].align+"><div class='th-title xz'>选择</div></th>"),s.append("<th width="+i[a].width+" align="+i[a].align+"><div class='th-title xz'>选择</div></th>")):(e.append("<th width="+i[a].width+" align="+i[a].align+"><div class='th-title'><span class='sort-icon'>"+i[a].title+"</span></div></th>"),s.append("<th width="+i[a].width+" align="+i[a].align+"><div class='th-title'><span class='sort-icon'>"+i[a].title+"</span></div></th>"))},createTableBody:function(i){function e(){for(var i=_op.settings.i+100;_op.settings.indSa<a.length;_op.settings.indSa++){var d=n[a[_op.settings.indSa]];if(_op.settings.ind>0&&_op.settings.ind==d.length)_op.settings.ind=0;else{for(;_op.settings.i<i;_op.settings.i++){if(_op.settings.otherfunction)var o=_op.settings.otherfunction(a[_op.settings.indSa],d[_op.settings.ind]);var l="",h=d[_op.settings.ind].image_is_save;l+='<tr id = "'+d[_op.settings.ind].image_satellite_type+"_image_tr_"+d[_op.settings.ind].data_id+'" dataid="'+d[_op.settings.ind].data_id+'" data-id="'+d[_op.settings.ind].data_id+'" class="" >';for(var c=0;c<s.length;c++)if("ck"==s[c].field)l+=h?0==h?"<td  width='"+s[c].width+"'><input data-index='0' name='btSelectItem' type='checkbox' id = \""+d[_op.settings.ind].image_satellite_type+"_image_checkbox_"+d[_op.settings.ind].data_id+'" id2="image_checkbox_'+d[_op.settings.ind].data_id+'" dataid="'+d[_op.settings.ind].data_id+'" dataname="'+d[_op.settings.ind].name+'"  dataid="'+d[_op.settings.ind].data_id+"\"  data-save='0' disabled='disabled' class='dataSave0'></td>":"<td  width='"+s[c].width+"'><input data-index='0' name='btSelectItem' type='checkbox' id = \""+d[_op.settings.ind].image_satellite_type+"_image_checkbox_"+d[_op.settings.ind].data_id+'" id2="image_checkbox_'+d[_op.settings.ind].data_id+'" dataid="'+d[_op.settings.ind].data_id+'" dataname="'+d[_op.settings.ind].name+'"  dataid="'+d[_op.settings.ind].data_id+"\"  data-save='1'></td>":"<td  width='"+s[c].width+"'><input data-index='0' name='btSelectItem' type='checkbox' id = \""+d[_op.settings.ind].image_satellite_type+"_image_checkbox_"+d[_op.settings.ind].data_id+'" id2="image_checkbox_'+d[_op.settings.ind].data_id+'" dataid="'+d[_op.settings.ind].data_id+'" dataname="'+d[_op.settings.ind].name+'"  dataid="'+d[_op.settings.ind].data_id+"\"  data-save='0' disabled='disabled' class='dataSave0'></td>";else if("cz"==s[c].field)l+="<td width='"+s[c].width+"' class='dc-botom-table-td-oper'><a class='detail-btn' id='muzhi_"+d[_op.settings.ind].id+"' title='点击查看拇指图和数据详情' data='"+o.jsonData+"'>详情</a><a class='dc3-table-icon dc3-tietu-eye' title='点击显示贴图' id='tietu_"+d[_op.settings.ind].id+"' data='"+d[_op.settings.ind].data_id+"thumbnailLayer'>贴图</a><a class='dc3-table-icon dc3-sunshine active' title='点击隐藏影像' id='sum_"+d[_op.settings.ind].data_id+"' data='"+d[_op.settings.ind].id+"thumbnailLayer' >隐藏</a></td>";else if("image_cloudage"==s[c].field)100==o[s[c].field]?l+="<td width='"+s[c].width+"'>-</td>":l+="<td width='"+s[c].width+"'>"+o[s[c].field]+"%</td>";else if("image_resolution"==s[c].field){var r=d[_op.settings.ind].image_resolution.replace("[","").replace("]","");l+="<td width='"+s[c].width+"'>"+r+"m</td>"}else l+="<td width='"+s[c].width+"'>"+o[s[c].field]+"</td>";if(l+="</tr>",t("#"+_op.settings.id+" tbody").append(l),++_op.settings.ind==d.length){_op.settings.i++,_op.settings.ind=0,_op.settings.indSa==a.length-1&&(_op.sortTable(),_op.appendCallback());break}}if(0!=_op.settings.ind&&_op.settings.ind<d.length&&_op.settings.i==i){setTimeout(function(){e()},100);break}}}}var s=_op.settings.columns;if(i){_op.settings.indSa=0,_op.settings.ind=0,_op.settings.i=0;var a=i.saList,n=i.topMap;t("#"+_op.settings.id+" tbody").empty(),t("#datagrid-tables").removeClass("dn"),t("#no-data-tables").addClass("dn"),e()}else if(_op.settings.data){var a=_op.settings.data.saList,n=_op.settings.data.topMap;t("#datagrid-tables").removeClass("dn"),t("#no-data-tables").addClass("dn"),e()}else t("#datagrid-tables").addClass("dn"),t("#no-data-tables").removeClass("dn"),t("#"+_op.settings.id+" tbody").empty().append('<tr class="no-records-found"><td colspan="10">没有找到匹配的记录</td></tr>')},createTableBody2:function(i){_op.settings.columns;if(i){appendTr()}else t("#"+_op.settings.id+" tbody").empty().append('<tr class="no-records-found"><td colspan="10">没有找到匹配的记录</td></tr>')},registercheckall:function(){t("input[name='chkall']").click(function(){this.checked?t("input[name='chk']").each(function(){t(this).attr("checked",!0)}):t("input[name='chk']").each(function(){t(this).attr("checked",!1)})})},sortTable:function(){new TableSorter("tbodyInit")},appendCallback:function(){if(_op.settings.callback)for(var t=0;t<_op.settings.callback.length;t++)_op.settings.callback[t]()},loadData:function(t){_op.settings.data=t,_op.createTableBody},loadWebSocketData:function(t){_op.settings.data=t,_op.createTableBody2}},t.fn.grid=function(t,e){var s=new i(this,t);return"string"==typeof t?"loadData"==t?s.createTableBody(e):s.createTableBody2(e):this.each(function(){s.init()})}}),TableSorter.prototype={$:function(t){return document.getElementById(t)},Init:function(t){this.Rows=[],this.Header=[],this.ViewState=[],this.LastSorted=null,this.NormalCss="NormalCss",this.SortAscCss="SortAscCss",this.SortDescCss="SortDescCss";for(var i=0;i<this.Table.rows.length;i++)this.Rows.push(this.Table.rows[i]);this.Header=$("#tbv2")[0].rows[0].cells;for(var i=0;i<(t.length?t.length:this.Header.length);i++){var e=t.length?t[i]:i;e>=this.Header.length||(this.ViewState[e]=!1,this.Header[e].style.cursor="pointer",e>0&&(this.Header[e].onclick=this.GetFunction(this,"Sort",e)))}},GetFunction:function(t,i,e){return function(){t[i](e)}},Sort:function(t){this.LastSorted&&(this.LastSorted.className=this.NormalCss);for(var i=!0,e=0;e<this.Rows.length&&i;e++)i=this.IsNumeric(this.Rows[e].cells[t].innerHTML);this.Rows.sort(function(e,s){var a,n,d;return n=e.cells[t].innerHTML,d=s.cells[t].innerHTML,n==d?0:(a=i?parseFloat(n)>parseFloat(d):n>d,a=a?1:-1)}),this.ViewState[t]?(this.Rows.reverse(),this.ViewState[t]=!1,this.Header[t].className=this.SortDescCss):(this.ViewState[t]=!0,this.Header[t].className=this.SortAscCss),this.LastSorted=this.Header[t];for(var s=document.createDocumentFragment(),e=0;e<this.Rows.length;e++)s.appendChild(this.Rows[e]);this.Table.appendChild(s),this.OnSorted(this.Header[t],this.ViewState[t])},IsNumeric:function(t){return/^\d+(\.\d+)?$/.test(t)},OnSorted:function(t,i){}};